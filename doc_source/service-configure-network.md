# Step 2: Configure a Network<a name="service-configure-network"></a>

**Important**  
Amazon ECS has provided a new console experience for creating a service\. For more information, see [ Creating a service using the new console  You can create an Amazon ECS service using the new Amazon ECS console\. To make the service creation process as easy as possible, the console has default selections for many choices which we describe below\. There are also help panels available for most of the sections in the console which provide further context\. To create a service using the new console Open the Amazon ECS console at [https://console\.aws\.amazon\.com/ecs/v2](https://console.aws.amazon.com/ecs/v2)\.  On the **Clusters** page, select the cluster to create the service in\.   From the **Services** tab, choose **Deploy**\.   The **Compute configuration** section can be expanded to change the compute option for your service to use\. By default, the console will select a compute option for you so in most cases you can go to the next step\. The following describes the order that the console uses to select a default:   If your cluster has a default capacity provider strategy defined, it will be selected\.   If your cluster doesn't have a default capacity provider strategy defined but you do have the Fargate capacity providers added to the cluster, a custom capacity provider strategy using the `FARGATE` capacity provider will be selected\.   If your cluster doesn't have a default capacity provider strategy defined but you do have one or more Auto Scaling group capacity providers added to the cluster, the **Use custom \(Advanced\)** option is selected and you will need to manually define the strategy\.   If your cluster doesn't have a default capacity provider strategy defined and no capacity providers added to the cluster, the Fargate launch type is selected\.     For **Application type**, select **Service**\.   For **Task definition**, choose the task definition family and revision to use\.  The console validates that the selected task definition family and revision is compatible with the defined compute configuration\. If you receive a warning, verify both your task definition compatibility and the compute configuration selected\.    For **Service name**, specify a name for your service\.   For **Desired tasks**, specify the number of tasks to launch and maintain in the service\.   The **Deployment options** section can be expanded to change the minimum healthy percent and maximum percent of running tasks allowed during a service deployment\. The console has default values for the most common use case selected\.  Currently, only the **Rolling update** \(`ECS`\) deployment type is supported\. To use any other deployment type, switch to the old console\.    \(Optional\) The **Load balancing** section can be expanded to configure a load balancer for your service\. Use the following steps to configure your service to use an Application Load Balancer\.   For **Load balancer type**, select **Application Load Balancer**\.   Choose **Create a new load balancer** to create a new Application Load Balancer or **Use an existing load balancer** to select an existing Application Load Balancer\.   When creating a new load balancer, for **Load balancer name**, specify a unique name for your load balancer\. When using an existing load balancer, for **Load balancer**, select your existing load balancer\.   For **Listener**, specify a port and protocol for the Application Load Balancer to listen for connection requests on\. By default, the load balancer will be configured to use port 80 and HTTP\.   For **Target group name**, specify a name and a protocol for the target group that the Application Load Balancer will route requests to\. By default, the target group will route requests to the first container defined in your task definition\.   For **Health check path**, specify a path that exists within your container where the Application Load Balancer should periodically send requests to verify the connection health between the Application Load Balancer and the container\. By default, a path of `/` is used which is the root directory\.   For **Health check grace period**, specify the amount of time \(in seconds\) that the service scheduler should ignore unhealthy Elastic Load Balancing target health checks for\.     The **Networking** section can be expanded to define the network configuration for the service\. Task definitions that use the `awsvpc` network mode or services configured to use a load balancer must have a networking configuration\. By default, the console selects the default Amazon VPC along with all subnets and the default security group within the default Amazon VPC\. Use the following steps to specify a custom configuration\.   For **VPC**, select the VPC to use\.   For **Subnets**, select one or more subnets in the VPC that the task scheduler should consider when placing your tasks\.   For **Security group**, you can either select an existing security group or create a new one\. To use an existing security group, select the security group and move to the next step\. To create a new security group, choose **Create a new security group**\. You must specify a security group name, description, and then add one or more inbound rules for the security group\.   For **Public IP**, choose whether to auto\-assign a public IP address to the elastic network interface \(ENI\) of the task\. Tasks that are launched on AWS Fargate can be assigned a public IP address when run using a public subnet so they have a route to the internet\. For more information, see [Fargate task networking](https://docs.aws.amazon.com/AmazonECS/latest/userguide/fargate-task-networking.html) in the *Amazon Elastic Container Service User Guide for AWS Fargate*\.     \(Optional\) The **Tags** section can be expanded to add tags, in the form of key\-value pairs, to the service\.   ](create-service-console-v2.md)\.

If your service's task definition uses the `awsvpc` network mode, you must configure a VPC, subnet, and security group for your service\.

If your service's task definition does not use the `awsvpc` network mode, you can move on to the next step, [Step 3: Configuring Your Service to Use a Load Balancer](service-create-loadbalancer.md)\.

The `awsvpc` network mode does not provide task ENIs with public IP addresses for tasks that use the EC2 launch type\. To access the internet, tasks that use the EC2 launch type must be launched in a private subnet that is configured to use a NAT gateway\. For more information, see [NAT Gateways](https://docs.aws.amazon.com/vpc/latest/userguide/vpc-nat-gateway.html) in the *Amazon VPC User Guide*\. Inbound network access must be from within the VPC using the private IP address or DNS hostname, or routed through a load balancer from within the VPC\. Tasks launched within public subnets do not have internet access\.

**Note**  
The above limitation does not apply to tasks that use the Fargate launch type\. You can configure these tasks to receive public IP addresses\.

**To configure VPC and security group settings for your service**

1. If you have not done so already, follow the basic service configuration procedures in [Step 1: Configuring Basic Service Parameters](basic-service-params.md)\.

1. For **Cluster VPC**, if you selected the EC2 launch type, choose the VPC in which your container instances reside\. If you selected the Fargate launch type, select the VPC that the Fargate tasks should use\. Ensure that the VPC you choose is not configured to require dedicated hardware tenancy, as that is not supported by Fargate tasks\.

1. For **Subnets**, choose the available subnets for your service task placement\.

1. For **Security groups**, a security group has been created for your service's tasks, which allows HTTP traffic from the internet \(0\.0\.0\.0/0\)\. To edit the name or the rules of this security group, or to choose an existing security group, choose **Edit** and then modify your security group settings\.

1. For **Auto\-assign Public IP**, choose whether to have your tasks receive a public IP address\. If you are using Fargate tasks, in order for the task to pull the container image it must either use a public subnet and be assigned a public IP address or a private subnet that has a route to the internet or a NAT gateway that can route requests to the internet\.

1. If you are configuring your service to use a load balancer or if you are using the green/blue deployment type, continue to [Step 3: Configuring Your Service to Use a Load Balancer](service-create-loadbalancer.md)\. If you are not configuring your service to use a load balancer, you can choose **None** as the load balancer type and move on to the next section, [Step 5: Configuring your service to use Service Auto Scaling](service-configure-auto-scaling.md)\.